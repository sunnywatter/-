<view class="chat-container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  - å¾®ä¿¡é£æ ¼ -->
  <view class="chat-header">
    <view class="header-content">
      <view class="sprite-avatar">
        <view class="sprite-face">
          <view class="sprite-eye left-eye"></view>
          <view class="sprite-eye right-eye"></view>
          <view class="sprite-mouth"></view>
        </view>
      </view>
      <view class="header-info">
        <text class="chat-title">åƒç´ é™ªä¼´ç²¾çµ</text>
        <text class="chat-status">{{sending ? 'æ­£åœ¨æ€è€ƒ...' : 'åœ¨çº¿'}}</text>
      </view>
      <view class="header-actions">
        <button class="action-btn" bindtap="onClearChat">ğŸ—‘ï¸</button>
        <button class="action-btn" bindtap="goToSettings">âš™ï¸</button>
      </view>
    </view>
  </view>

  <!-- èŠå¤©æ¶ˆæ¯åŒºåŸŸ -->
  <scroll-view 
    class="messages-container"
    scroll-y="{{true}}"
    scroll-with-animation="{{true}}"
    scroll-into-view="{{scrollIntoView}}"
    enhanced="{{true}}"
    show-scrollbar="{{false}}"
    enable-back-to-top="{{true}}"
  >
    <!-- æ¬¢è¿æ¶ˆæ¯ -->
    <view class="welcome-section" wx:if="{{messages.length === 0 && showQuickReplies}}">
      <view class="welcome-sprite">
        <view class="large-sprite-head">
          <view class="large-eye left"></view>
          <view class="large-eye right"></view>
          <view class="large-mouth"></view>
        </view>
      </view>
      <text class="welcome-text">ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„åƒç´ é™ªä¼´ç²¾çµ âœ¨\næœ‰ä»€ä¹ˆæƒ³èŠçš„å—ï¼Ÿ</text>
      
      <!-- å¿«æ·å›å¤ -->
      <view class="quick-replies">
        <button 
          class="quick-reply-btn"
          wx:for="{{quickReplies}}"
          wx:key="index"
          data-text="{{item}}"
          bindtap="onQuickReply"
        >
          {{item}}
        </button>
      </view>
    </view>

    <!-- èŠå¤©æ¶ˆæ¯åˆ—è¡¨ -->
    <view class="messages-list">
      <view 
        class="message-item {{item.role}}"
        wx:for="{{messages}}"
        wx:key="id"
      >
        <view class="message-avatar {{item.role}}">
          <text class="avatar-icon">{{item.role === 'user' ? 'ğŸ˜Š' : 'ğŸ¤–'}}</text>
        </view>
        
        <view class="message-bubble {{item.role}}">
          <view class="bubble-content">{{item.content}}</view>
          <view class="bubble-time">{{item.time}}</view>
        </view>
      </view>
    </view>

    <!-- æ­£åœ¨è¾“å…¥æŒ‡ç¤ºå™¨ -->
    <view class="typing-indicator" wx:if="{{sending}}">
      <view class="message-avatar assistant">
        <text class="avatar-icon">ğŸ¤–</text>
      </view>
      <view class="typing-bubble">
        <view class="typing-dots">
          <view class="dot"></view>
          <view class="dot"></view>
          <view class="dot"></view>
        </view>
      </view>
    </view>

    <!-- æ»šåŠ¨é”šç‚¹ -->
    <view id="{{scrollIntoView}}" class="scroll-anchor"></view>
  </scroll-view>

  <!-- åº•éƒ¨è¾“å…¥åŒºåŸŸ - å¾®ä¿¡é£æ ¼ -->
  <view class="input-container">
    <view class="input-wrapper">
      <textarea
        class="message-input"
        value="{{inputText}}"
        placeholder="å’Œç²¾çµåˆ†äº«ä½ çš„å¿ƒæƒ…..."
        bindinput="onInputChange"
        bindfocus="onInputFocus"
        bindblur="onInputBlur"
        maxlength="1000"
        auto-height="{{true}}"
        show-confirm-bar="{{false}}"
        cursor-spacing="8"
        adjust-position="{{true}}"
      />
    </view>
    
    <button 
      class="send-button {{sending ? 'sending' : ''}}"
      bindtap="onSendMessage"
      disabled="{{sending}}"
    >
      <text class="send-text">{{sending ? 'å‘é€ä¸­' : 'å‘é€'}}</text>
    </button>
  </view>

  <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸ -->
  <view class="safe-area-bottom"></view>
</view>